<%= form_with(model: @assembly) do |form| %>
  <% if @assembly.errors.any? %>
    <div style="color: red">
      <h2><%= pluralize(@assembly.errors.count, "error") %> prohibited this assembly from being saved:</h2>

      <ul>
        <% @assembly.errors.each do |error| %>
          <li><%= error.full_message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div>
    <%= form.label :name, t('views.assemblies.index.name'), style: "display: block" %>
    <%= form.text_field :name %>
  </div>

<br>

  <div>
    <%= form.label :book_id, t('views.assemblies.form.book_title'), style: "display: block" %>
    <%= form.collection_select :book_id, Book.all, :id, :title, prompt: t('views.assemblies.form.select_book') %>
  </div>

<br>

  <div>
    <%= form.label :parts, t('views.assemblies.form.parts'), style: "display: block" %>
    <div class="flex items-center space-x-2">
      <div class="w-1/2">
        <div class="container">
          <%= form.collection_check_boxes :part_ids, Part.all, :id, :name do |b| %>
            <label class="block">
              <%= b.check_box + b.text %>
            </label>
          <% end %>
        </div>
      </div>
      <button type="button" id="add-part-button" class="px-4 py-2 bg-blue-500 text-white rounded-lg cursor-pointer" onclick="document.getElementById('myModal').classList.toggle('hidden');">Adicionar Peça</button>
    </div>

    <div id="myModal" class="hidden fixed z-10 inset-0 overflow-y-auto">
      <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
        <div class="fixed inset-0 transition-opacity" aria-hidden="true">
          <div class="absolute inset-0 bg-gray-500 opacity-75"></div>
        </div>
        <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
        <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full" role="dialog" aria-modal="true" aria-labelledby="modal-headline">
          <!-- Aqui será renderizado o formulário da parte (part/new) -->
          <%= render "parts/form" %>
        </div>
      </div>
    </div>

    <%= form.submit @assembly.persisted? ? t('views.assemblies.form.update') : t('views.assemblies.form.create'), class: (@assembly.persisted? ? "bg-yellow-500 text-white font-bold py-2 px-4 rounded-full cursor-pointer" : "bg-green-500 text-white font-bold py-2 px-4 rounded-full cursor-pointer") %>
  </div>
<% end %>
